<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" type="text/css" href="structpres.css"/>
    <script src="structpres.js"></script>
    <title>Clever Things People Do In Groovy So You Have To Know About Them</title>
</head>

<body>

<div class="slide title">

<div class="cc">
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
<img alt="Creative Commons Licence" src="cc-by-sa-4.png" /></a>
This work is licensed under a
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons<br />Attribution-ShareAlike 4.0 International License</a>
</div>

<h1 class="seriestitle">Clever Things People Do In Groovy So You Have To Know About Them</h1>

<address>Andy Balaam<br>
<a href="http://www.artificialworlds.net/blog">artificialworlds.net/blog</a>
</address>
</div>


<a name="contents"></a>
<div class="slide">
<div class="slide_body">
<h1>Contents</h1>
<ul>
    <li>Motivation</li>
    <li>Optional things</li>
    <li>Extension methods</li>
    <li>Operator overloading</li>
    <li>Trailing closures</li>
    <li>build.gradle and Jenkinsfile</li>
    <li>Gotchas / fun</li>
</ul>
</div>
</div>


<a name="slide_1"></a>
<div class="slide">
<div class="slide_body">
<h1>Motivation</h1>
</div>
</div>


<a name="slide_2"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional semicolons</h1>
<code>a = 3 + 1
println(a)
</code>
</div>
</div>


<a name="slide_3"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional semicolons</h1>
<code>a = 3 + 1
println(a)
</code>
<code class="output">4
</code>
</div>
</div>


<a name="slide_4"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional semicolons</h1>
<code>b = 3
+ 1
println(b)
</code>
</div>
</div>


<a name="slide_5"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional semicolons</h1>
<code>b = 3
+ 1
println(b)
</code>
<code class="output">3
</code>
</div>
</div>


<a name="slide_6"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional semicolons</h1>
<code>c = 3\
+ 1
println(c)
</code>
</div>
</div>


<a name="slide_7"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional semicolons</h1>
<code>c = 3\
+ 1
println(c)
</code>
<code class="output">4
</code>
</div>
</div>


<a name="slide_8"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional semicolons</h1>
<code>d = (3
+ 1)
println(d)
</code>
</div>
</div>


<a name="slide_9"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional semicolons</h1>
<code>d = (3
+ 1)
println(d)
</code>
<code class="output">4
</code>
</div>
</div>


<a name="slide_10"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional parentheses and dots</h1>
<code>def printArgs(a, b) {
    println(a)
    println(b)
}
printArgs(1, 2)
</code>
</div>
</div>


<a name="slide_11"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional parentheses and dots</h1>
<code>def printArgs(a, b) {
    println(a)
    println(b)
}
printArgs(1, 2)
</code>
<code class="output">1
2
</code>
</div>
</div>


<a name="slide_12"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional parentheses and dots</h1>
<code>def printArgs(a, b) {
    println(a)
    println(b)
}
printArgs 3, 4
</code>
</div>
</div>


<a name="slide_13"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional parentheses and dots</h1>
<code>def printArgs(a, b) {
    println(a)
    println(b)
}
printArgs 3, 4
</code>
<code class="output">3
4
</code>
</div>
</div>


<a name="slide_14"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional parentheses and dots</h1>
<code>def printArgs(a, b) {
    println(a)
    println(b)
}
printArgs(5) 6
</code>
</div>
</div>


<a name="slide_15"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional parentheses and dots</h1>
<code>def printArgs(a, b) {
    println(a)
    println(b)
}
printArgs(5) 6
</code>
<code class="output">Caught: groovy.lang.MissingMethodException: No signature of method: tmp.printArgs() is applicable for argument types: (java.lang.Integer) values: [5]
</code>
</div>
</div>


<a name="slide_16"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional parentheses and dots</h1>
<code>def printArgs(a, b) {
    println(a)
    println(b)
}
printArgs(5) {}
</code>
</div>
</div>


<a name="slide_17"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional parentheses and dots</h1>
<code>def printArgs(a, b) {
    println(a)
    println(b)
}
printArgs(5) {}
</code>
<code class="output">5
tmp$_run_closure1@1ffe63b9
</code>
</div>
</div>


<a name="slide_18"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional parentheses and dots</h1>
<code>def printArgs(a, b) {
    println(a)
    println(b)
}
printArgs(5) {println("6")}
</code>
</div>
</div>


<a name="slide_19"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional parentheses and dots</h1>
<code>def printArgs(a, b) {
    println(a)
    println(b)
}
printArgs(5) {println("6")}
</code>
<code class="output">5
tmp$_run_closure1@1ffe63b9
</code>
</div>
</div>


<a name="slide_20"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional square brackets</h1>
<code>x = [a:3, b:4]
println(x)
</code>
</div>
</div>


<a name="slide_21"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional square brackets</h1>
<code>x = [a:3, b:4]
println(x)
</code>
<code class="output">[a:3, b:4]
</code>
</div>
</div>


<a name="slide_22"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional square brackets</h1>
<code>x = a:3, b:4
println(x)
</code>
</div>
</div>


<a name="slide_23"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional square brackets</h1>
<code>x = a:3, b:4
println(x)
</code>
<code class="output">org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed:
/home-andrebal-writing/groovy/videos-groovy-clever-things/groovy-maze/tmp.groovy: 1: expecting EOF, found ':' @ line 1, column 6.
   x = a:3, b:4
        ^

1 error
</code>
</div>
</div>


<a name="slide_24"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional square brackets</h1>
<code>println(a:3, b:4)
</code>
</div>
</div>


<a name="slide_25"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional square brackets</h1>
<code>println(a:3, b:4)
</code>
<code class="output">[a:3, b:4]
</code>
</div>
</div>


<a name="slide_26"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional square brackets</h1>
<code>println a:3, b:4
</code>
</div>
</div>


<a name="slide_27"></a>
<div class="slide">
<div class="slide_body">
<h1>Optional square brackets</h1>
<code>println a:3, b:4
</code>
<code class="output">[a:3, b:4]
</code>
</div>
</div>


<a name="slide_28"></a>
<div class="slide">
<div class="slide_body">
<h1>Extension methods</h1>
<code>4.times {println("Andy is cool")}
</code>
</div>
</div>


<a name="slide_29"></a>
<div class="slide">
<div class="slide_body">
<h1>Extension methods</h1>
<code>4.times {println("Andy is cool")}
</code>
<code class="output">Andy is cool
Andy is cool
Andy is cool
Andy is cool
</code>
</div>
</div>


<a name="slide_30"></a>
<div class="slide">
<div class="slide_body">
<h1>Extension methods</h1>
<code>def letters = new TreeMap([
    "a": 2,
    "b": 3,
    "c": 4,
    "z": 1,
])
letters.each {println(it)}
</code>
</div>
</div>


<a name="slide_31"></a>
<div class="slide">
<div class="slide_body">
<h1>Extension methods</h1>
<code>def letters = new TreeMap([
    "a": 2,
    "b": 3,
    "c": 4,
    "z": 1,
])
letters.each {println(it)}
</code>
<code class="output">a=2
b=3
c=4
z=1
</code>
</div>
</div>


<a name="slide_32"></a>
<div class="slide">
<div class="slide_body">
<h1>Extension methods</h1>
<code>def letters = new TreeMap(["a":2, "b":3, "c":4, "z":1])
Map.metaClass.eachInValueOrder = {
    entries = new ArrayList(entrySet())
    entries.sort({e1, e2 -&gt; e1.getValue() - e2.getValue()})
    entries.each(it)
}
letters.eachInValueOrder {println(it)}
</code>
</div>
</div>


<a name="slide_33"></a>
<div class="slide">
<div class="slide_body">
<h1>Extension methods</h1>
<code>def letters = new TreeMap(["a":2, "b":3, "c":4, "z":1])
Map.metaClass.eachInValueOrder = {
    entries = new ArrayList(entrySet())
    entries.sort({e1, e2 -&gt; e1.getValue() - e2.getValue()})
    entries.each(it)
}
letters.eachInValueOrder {println(it)}
</code>
<code class="output">z=1
a=2
b=3
c=4
</code>
</div>
</div>


<a name="slide_34"></a>
<div class="slide">
<div class="slide_body">
<h1>Operator overloading</h1>
<code>class PipeConcat {
    String c
    def plus(y) {
        "$c|$y.c"
    }
}
def x = new PipeConcat(c:"foo")
def y = new PipeConcat(c:"bar")
println(x + y)
</code>
</div>
</div>


<a name="slide_35"></a>
<div class="slide">
<div class="slide_body">
<h1>Operator overloading</h1>
<code>class PipeConcat {
    String c
    def plus(y) {
        "$c|$y.c"
    }
}
def x = new PipeConcat(c:"foo")
def y = new PipeConcat(c:"bar")
println(x + y)
</code>
<code class="output">foo|bar
</code>
</div>
</div>

<a name="slide_36"></a>
<div class="slide">
<div class="slide_body">
<h1>Example</h1>
</div>
</div>


<a name="slide_37"></a>
<div class="slide">
<div class="slide_body">
<h1>Example</h1>
<code>_%_%_%_%_%_%_%_%_%_%_%_%_%_%_%_%_%_
_%_*_._._._._._._%_._._._._._._*_%_
_%_._%_%_._%_._%_%_%_._%_._%_%_._%_
_%_._._._._%_._._._._._%_._._._._._
_%_%_%_%_._%_%_%_._%_%_%_._%_%_%_%_
_._._._._._%_._|_._|_._%_._._._._._
_%_%_%_%_._%_%_%_._%_%_%_._%_%_%_%_
_%_._._._._%_._._._._._%_._._._._._
_%_._%_%_._%_._%_%_%_._%_._%_%_._%_
_%_*_+_._._._._._%_._._._._._._*_%_
_%_%_%_%_%_%_%_%_%_%_%_%_%_%_%_%_%_
</code>
</div>
</div>


<a name="slide_38"></a>
<div class="slide">
<div class="slide_body">
<h1>Example</h1>
<code>class MazeUnderScore {
    def mod(MazeUnderScore other) { this }
    def or(MazeUnderScore other) { this }
    def plus(MazeUnderScore other) { this }
    def multiply(MazeUnderScore other) { this }
    def get_() { new MazeUnderScore() }
}
def _ = new MazeUnderScore()
</code>
</div>
</div>


<a name="slide_39"></a>
<div class="slide">
<div class="slide_body">
<h1>Example</h1>
<code>// ...
logic = new Logic()
// ...

at start then ghosts.mode becomes normal
when ghost hits player then player dies
when player hits pill then ghosts.mode becomes scared and pill becomes deleted
rules done

logic.rules.each {println(it)}
</code>
</div>
</div>


<a name="slide_40"></a>
<div class="slide">
<div class="slide_body">
<h1>Example</h1>
<code>// ...
logic = new Logic()
// ...

at start then ghosts.mode becomes normal
when ghost hits player then player dies
when player hits pill then ghosts.mode becomes scared and pill becomes deleted
rules done

logic.rules.each {println(it)}
</code>
<code class="output">on(start, setValue(ghosts.mode, normal))
on(ghost.hits(player), dies(player, null))
on(player.hits(pill), setValue(ghosts.mode, scared))
on(player.hits(pill), setValue(pill, deleted))
</code>
</div>
</div>


<a name="slide_41"></a>
<div class="slide">
<div class="slide_body">
<h1>Example</h1>
<code>class Logic {
    def rules = []
    // ...
    def at(time) {
        changeEvent(time)
    }
    // ...
    def then(object) {
        changeObject(object)
    }
}
</code>
</div>
</div>


<a name="slide_42"></a>
<div class="slide">
<div class="slide_body">
<h1>Trailing closures</h1>
<code>def doItTwice(fn) {
    fn()
    fn()
}
doItTwice({println("d")})
</code>
</div>
</div>


<a name="slide_43"></a>
<div class="slide">
<div class="slide_body">
<h1>Trailing closures</h1>
<code>def doItTwice(fn) {
    fn()
    fn()
}
doItTwice({println("d")})
</code>
<code class="output">d
d
</code>
</div>
</div>


<a name="slide_44"></a>
<div class="slide">
<div class="slide_body">
<h1>Trailing closures</h1>
<code>def doItTwice(fn) {
    fn()
    fn()
}
doItTwice {
    println("e")
}
</code>
</div>
</div>


<a name="slide_45"></a>
<div class="slide">
<div class="slide_body">
<h1>Trailing closures</h1>
<code>def doItTwice(fn) {
    fn()
    fn()
}
doItTwice {
    println("e")
}
</code>
<code class="output">e
e
</code>
</div>
</div>


<a name="slide_46"></a>
<div class="slide">
<div class="slide_body">
<h1>build.gradle</h1>
<code>dependencies {
    compile group: 'org.slf4j', name: 'slf4j-api', version: '1.7.22'
}
</code>
</div>
</div>


<a name="slide_47"></a>
<div class="slide">
<div class="slide_body">
<h1>build.gradle</h1>
<code>// Implicit static imports of dependencies and compile
dependencies({
    compile(["group": 'org.slf4j', "name": 'slf4j-api', "version": '1.7.22']);
});
</code>
</div>
</div>


<a name="slide_48"></a>
<div class="slide">
<div class="slide_body">
<h1>Jenkinsfile</h1>
<code>pipeline {
    stages {
        stage('Build') {
            steps {
                echo "Building all the projects"
                dir('sms/whist') {
                    catchError {
                        sh "make"
</code>
</div>
</div>


<a name="slide_49"></a>
<div class="slide">
<div class="slide_body">
<h1>Jenkinsfile</h1>
<code>// Implicit static imports ...
pipeline({
    stages({
        stage('Build', {
            steps( {
                echo("Building all the projects")
                dir('sms/whist', {
                    catchError( {
                        sh("make")
</code>
</div>
</div>


<a name="slide_50"></a>
<div class="slide">
<div class="slide_body">
<h1>Gotcha: String interpolation</h1>
<code>dontRunMe = {-&gt;
    println("dontRunMe!")
    "you ran me, didn't you?"
}
println(dontRunMe)
"dontRunMe=$dontRunMe"
</code>
</div>
</div>


<a name="slide_51"></a>
<div class="slide">
<div class="slide_body">
<h1>Gotcha: String interpolation</h1>
<code>dontRunMe = {-&gt;
    println("dontRunMe!")
    "you ran me, didn't you?"
}
println(dontRunMe)
"dontRunMe=$dontRunMe"
</code>
<code class="output">dontrunme1$_run_closure1@4690b489
</code>
</div>
</div>


<a name="slide_52"></a>
<div class="slide">
<div class="slide_body">
<h1>Gotcha: String interpolation</h1>
<code>dontRunMe = {-&gt;
    println("dontRunMe!")
    "you ran me, didn't you?"
}
println(dontRunMe)
"dontRunMe=$dontRunMe".toUpperCase()
</code>
</div>
</div>


<a name="slide_53"></a>
<div class="slide">
<div class="slide_body">
<h1>Gotcha: String interpolation</h1>
<code>dontRunMe = {-&gt;
    println("dontRunMe!")
    "you ran me, didn't you?"
}
println(dontRunMe)
"dontRunMe=$dontRunMe".toUpperCase()
</code>
<code class="output">dontrunme1$_run_closure1@4690b489
dontRunMe!
</code>
</div>
</div>


<a name="slide_54"></a>
<div class="slide">
<div class="slide_body">
<h1>Fun</h1>
<code>yoable = [yo:null]
def coolPrint(message) {
    println(message)
    yoable
}
coolPrint("s'up?")
</code>
</div>
</div>


<a name="slide_55"></a>
<div class="slide">
<div class="slide_body">
<h1>Fun</h1>
<code>yoable = [yo:null]
def coolPrint(message) {
    println(message)
    yoable
}
coolPrint("s'up?")
</code>
<code class="output">s'up?</code>
</div>
</div>


<a name="slide_56"></a>
<div class="slide">
<div class="slide_body">
<h1>Fun</h1>
<code>yoable = [yo:null]
def coolPrint(message) {
    println(message)
    yoable
}
coolPrint("s'up?") yo
</code>
</div>
</div>


<a name="slide_57"></a>
<div class="slide">
<div class="slide_body">
<h1>Fun</h1>
<code>yoable = [yo:null]
def coolPrint(message) {
    println(message)
    yoable
}
coolPrint("s'up?") yo
</code>
<code class="output">s'up?</code>
</div>
</div>


<a name="slide_58"></a>
<div class="slide">
<div class="slide_body">
<h1>Questions?</h1>
</div>
</div>
